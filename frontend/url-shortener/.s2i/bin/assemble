#!/bin/bash

# Exit immediately if a command exits with a non-zero status
set -e

# Copy the project files to the application directory
mkdir -p /opt/app-root/src
cp -R /tmp/src/* /opt/app-root/src/

# Set ownership and permissions
chown -R 1001:0 /opt/app-root/src

# Navigate to the application directory
cd /opt/app-root/src

# Install dependencies
npm install

# Fix permissions for specific directory causing issue
mkdir -p node_modules/.vite
chown -R 1001:0 node_modules/.vite

# Run the application
npm run dev
